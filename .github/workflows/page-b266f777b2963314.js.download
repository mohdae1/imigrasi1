(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[278],{2480:function(){},2925:function(e,t,s){Promise.resolve().then(s.bind(s,6977))},6977:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ez}});var a=s(7437),r=s(1218),i=s.n(r),n=s(2643),l=s(903),o=s(9291),c=s(6380);let d=(0,l.U)((0,o.tJ)(e=>({isBot:!0,setIsBot:t=>e({isBot:t}),blocked:!1,setBlocked:t=>e({blocked:t}),newMessage:[],setNewMessages:t=>e({newMessage:t}),isLoadMore:!0,setIsLoadMore:t=>e({isLoadMore:t}),comments:[],setComments:t=>e({comments:t}),lastCommentId:0,setLastCommentId:t=>e({lastCommentId:t}),disabledButton:!0,setDisabledButton:t=>e({disabledButton:t})}),{name:"cr",storage:{getItem:e=>{let t=localStorage.getItem(e);return t?(0,c.pe)(t):null},setItem:(e,t)=>{localStorage.setItem(e,(0,c.HI)(t))}},partialize:e=>({lastCommentId:e.lastCommentId,isBot:e.isBot,blocked:e.blocked})})),m=new(i());m.init({AppId:n.j8,options:{newMessagesCallback(e){let{setNewMessages:t}=d.getState();t([e])}},mode:"widget"});var u=s(8472),g=s(357);u.Z.create({baseURL:n.Vw,headers:{"Content-Type":"application/json","X-Api-Key":n.ei}}),u.Z.create({baseURL:n.Vw,headers:{"Content-Type":"application/json","X-Api-Key":g.env.NEXT_PUBLIC_API_WEBHOOK_NEW_KEY}}),u.Z.create({baseURL:n.Q1,headers:{"Content-Type":"application/json","QISCUS-SDK-SECRET":n.NN,"QISCUS-SDK-APP-ID":n.j8}});let p=Date.now(),h=(0,c.SG)(p),f=e=>[{app_code:"odrkz-jkgdwun8eevlqka",chat_type:"group",comment_before_id:1,email:"odrkz-jkgdwun8eevlqka_admin@qismo.com",extras:{action:"bot_reply"},id:1,id_str:"2397303209",is_public_channel:!1,message:"\uD83D\uDC4B Welcome to Helpdesk Chatbot, your virtual assistant for all questions about Indonesian visas and immigration!",payload:{},room_avatar:"https://your-avatar-url",room_type:"group",room_options:'{"notes": "", "extras": null, "origin": null, "channel": "bot_identifier_imigrasi", "app_code": "odrkz-jkgdwun8eevlqka", "channel_id": 3011, "is_waiting": true, "room_badge": "https://d1edrlpyc25xu0.cloudfront.net/ods-cc6rmwouax2thbow3/image/upload/PFj-ORel8b/custom.svg", "is_resolved": false, "is_handled_by_bot": true}',status:"delivered",timestamp:e||h,type:"text",user_avatar:"https://dnlbo7fgjcc7f.cloudfront.net/odrkz-jkgdwun8eevlqka/image/upload/t_KCFsdoK1/LOGO-IMIGRASI.png",user_avatar_url:"https://dnlbo7fgjcc7f.cloudfront.net/odrkz-jkgdwun8eevlqka/image/upload/t_KCFsdoK1/LOGO-IMIGRASI.png",user_extras:{is_customer:!1,type:"agent",user_bubble_color:null},username:"Imigrasi"},{app_code:"odrkz-jkgdwun8eevlqka",chat_type:"group",comment_before_id:2,email:"odrkz-jkgdwun8eevlqka_admin@qismo.com",extras:{action:"bot_reply"},id:2,id_str:"2397303209",is_public_channel:!1,message:"I'm here to help you with visa application processes, requirements, and any other general inquiries.",payload:{},room_avatar:"https://your-avatar-url",room_type:"group",room_options:'{"notes": "", "extras": null, "origin": null, "channel": "bot_identifier_imigrasi", "app_code": "odrkz-jkgdwun8eevlqka", "channel_id": 3011, "is_waiting": true, "room_badge": "https://d1edrlpyc25xu0.cloudfront.net/ods-cc6rmwouax2thbow3/image/upload/PFj-ORel8b/custom.svg", "is_resolved": false, "is_handled_by_bot": true}',status:"delivered",timestamp:e||h,type:"text",user_avatar:"https://dnlbo7fgjcc7f.cloudfront.net/odrkz-jkgdwun8eevlqka/image/upload/t_KCFsdoK1/LOGO-IMIGRASI.png",user_avatar_url:"https://dnlbo7fgjcc7f.cloudfront.net/odrkz-jkgdwun8eevlqka/image/upload/t_KCFsdoK1/LOGO-IMIGRASI.png",user_extras:{is_customer:!1,type:"agent",user_bubble_color:null},username:"Imigrasi"},{app_code:"odrkz-jkgdwun8eevlqka",chat_type:"group",comment_before_id:2,email:"odrkz-jkgdwun8eevlqka_admin@qismo.com",extras:{action:"bot_reply"},id:3,id_str:"2397303209",is_public_channel:!1,message:"How can I assist you today?",payload:{},room_avatar:"https://your-avatar-url",room_type:"group",room_options:'{"notes": "", "extras": null, "origin": null, "channel": "bot_identifier_imigrasi", "app_code": "odrkz-jkgdwun8eevlqka", "channel_id": 3011, "is_waiting": true, "room_badge": "https://d1edrlpyc25xu0.cloudfront.net/ods-cc6rmwouax2thbow3/image/upload/PFj-ORel8b/custom.svg", "is_resolved": false, "is_handled_by_bot": true}',status:"delivered",timestamp:e||h,type:"text",user_avatar:"https://dnlbo7fgjcc7f.cloudfront.net/odrkz-jkgdwun8eevlqka/image/upload/t_KCFsdoK1/LOGO-IMIGRASI.png",user_avatar_url:"https://dnlbo7fgjcc7f.cloudfront.net/odrkz-jkgdwun8eevlqka/image/upload/t_KCFsdoK1/LOGO-IMIGRASI.png",user_extras:{is_customer:!1,type:"agent",user_bubble_color:null},username:"Imigrasi"}];var x=s(2709),y=s(4002),v=s(3375);let{setErrorLogin:j,setIsLoading:w}=x.i.getState(),b=(0,l.U)((0,o.tJ)((e,t)=>({firstLogin:!1,setFirstLogin:t=>e({firstLogin:t}),user:[],setupUser:async s=>{try{let a=(0,c.pV)(s),r=await m.setUser(s,s,a,null,{customer:!0});return e({user:JSON.stringify(m.userData)}),r&&await m.setUserWithIdentityToken({user:JSON.parse(t().user)}),e({firstLogin:!0}),await t().setSasToken(),!0}catch(e){return j("Invalid email or password"),w(!1),!1}},isLoggedIn:!1,setIsLoggedIn:t=>e({isLoggedIn:t}),email:"",setEmail:t=>e({email:t}),roomId:"",setRoomId:async t=>{try{let a=await (0,y.LL)(t);if(!0!==a.success)j(a.message),w(!1);else{var s=a.data.data[0]?a.data.data[0].room_id:a.data.data.room_id;let r=(0,v.getCookie)("data"),i=(0,c.NV)(r),n=await fetch("/api/decrypt",{method:"POST",body:JSON.stringify({token:i})}),l=(await n.json()).data.replace(/"/g,"");return await fetch("/api/get-region",{method:"POST",body:JSON.stringify({newRoomId:s,jwtToken:l})}),e({email:t,roomId:s,isLoggedIn:!0}),{roomId:s}}}catch(e){j("Please contact the administrator, we will back soon"),w(!1)}},sasToken:"",setSasToken:async()=>{try{let t=await fetch("/api/generate-sas-token",{method:"GET"}),s=await t.json();e({sasToken:s.data.data.sas_token})}catch(e){console.log("error",e)}}}),{name:"at",storage:{getItem:e=>{let t=localStorage.getItem(e);return t?(0,c.pe)(t):null},setItem:(e,t)=>{localStorage.setItem(e,(0,c.HI)(t))}}}));var N=s(9714);let k={httpOnly:!1,secure:!0,sameSite:"strict",path:"/",domain:s(357).env.NEXT_MAIN_DOMAIN};var _=s(4160);let I=async e=>{try{let t=(0,c.NV)(e),s=await fetch("/api/decrypt",{method:"POST",body:JSON.stringify({token:t})}),a=(await s.json()).data,r=(0,N.o)(a),i=(0,c.NV)(r.data),n=await fetch("/api/decrypt",{method:"POST",body:JSON.stringify({token:i})}),l=(await n.json()).data;return JSON.parse(l)}catch(e){return!1}},S=async e=>{try{let t=await fetch("/api/refresh-token",{method:"POST",body:JSON.stringify({refresh_token:e})}),s=await t.json(),a=await fetch("/api/encrypt",{method:"POST",body:JSON.stringify({token:s.data.data.access_token})}),r=(await a.json()).data,i=_.serialize("data",(0,c.oF)(r),k);return document.cookie=i,!0}catch(e){return console.error("Error refreshing token:",e),!1}},C=()=>{localStorage.clear();let e=document.cookie.split("; ");if(1!==e.length||""!==e[0])for(let t of e){let e=t.indexOf("="),s=e>-1?t.substr(0,e):t;(0,v.deleteCookie)(s,{path:"/",domain:".imigrasi.go.id"})}},E=async()=>{let e=(0,v.getCookie)("data");if(e){let t=await I(e);return{email:t.email,username:t.username}}};var L=s(2847);let{setComments:O,setLastCommentId:F,setIsBot:T,setBlocked:R,setNewMessages:A,setIsLoadMore:P,disabledButton:M,setDisabledButton:D,test:U}=d.getState(),{setTimeleft:W,setCountdown:z,setIsWaiting:K,countdown:q,setErrorLogin:B,setFirstLoad:H,isWaiting:G}=x.i.getState(),{setIsLoggedIn:J,email:Z}=b.getState(),X=async(e,t)=>{try{var s,a;if(!e)return console.error("Invalid roomId"),[];let r=await m.loadComments(e);if(!Array.isArray(r)||0===r.length)return console.log("No comments found or invalid response"),O([]),F(null),T(!1),P(!1),[];let i=r.some(e=>0===e.comment_before_id),n=i?r[r.length-1].timestamp:"",l=i?[...f(n)].reverse():[],o=r.reduce((e,t)=>0===t.comment_before_id?(P(!1),[...e,...l]):[...e,t],[]),c=r[r.length-1],d=o.length>0?c.id:null;F(d);let u=!o.some(e=>{var t;return null==e?void 0:null===(t=e.message)||void 0===t?void 0:t.includes("please feel free to reply to this message and reference your ticket number")})&&(null===(a=o.find(e=>e.email!==t))||void 0===a?void 0:null===(s=a.extras)||void 0===s?void 0:s.action)==="bot_reply";T(u);let g=[...o].reverse();return setTimeout(()=>{O(g),o.some(e=>e.message.includes("this conversation as resolved")||e.message.includes("This conversation was marked as resolved"))&&(et(t,e).catch(e=>{console.error("Failed to mark chat as resolved:",e)}),es())},0),o}catch(e){return console.error("Failed to load room comments:",e),O([]),F(null),T(!1),P(!1),[]}},Y=async(e,t,s,a,r,i)=>{await m.sendComment(e,t,s,a,r,i)},V=async e=>{let t=await I(e),s=Math.floor(Date.now()/1e3);return t.exp>s?{token:!0,timeleft:t.exp-s}:{token:!1,timeleft:0}},Q=async(e,t,s,a)=>{let r=t[0][0],i="System"===r.username,n=r.message.includes("this conversation as resolved")||r.message.includes("This conversation was marked as resolved");if(i&&n){await et(s,a),es();return}let l=/\[file\]|\[\/file\]/g.test(r.message),o=JSON.parse(r.room_options).is_handled_by_bot;l&&!0===o?(O([...e,...t[0]]),K(!0)):!0===o&&(O([...e,...t[0]]),K(!1)),!1===o&&(T(!1),O([...e,...t[0]]),K(!1)),A([])},$=e=>{let t=e.map(e=>e.message),s=t.some(e=>e.includes("You have been block due to our privacy and policy violation")),a=t.some(e=>e.includes("You are permanently blocked from using this service"));return{status:s||a,permanentBlock:a}},ee=async(e,t)=>{let s=$(e);if(null==s?void 0:s.status){if(0===q){let e=await fetch("/api/block-time?roomId=".concat(t),{method:"GET"}),s=await e.json();if(200===e.status){let e=Math.floor(Date.now()/1e3),t=Math.floor(s.data.data.epoch_time_blocked/1e3);W(t-e),z(t)}}s.permanentBlock&&R(!0)}},et=async(e,t)=>{try{let s={room_id:t,ip_address:"192.0.0.1",exp:Math.floor(Date.now()/1e3)+10},a=new TextEncoder().encode("Xd6ngWmRLZHWJIp,A#;^9@]OTXKzFeiP&!O3fFJY$k{;sdc$;Z"),r=await new L.N(s).setProtectedHeader({alg:"HS256"}).sign(a);await ea(e),await fetch("/api/chat-resolved",{method:"POST",body:JSON.stringify({room_id:r})})}catch(e){console.log("error",e)}},es=e=>{H(!1),O([]),K(!1),J(!1),R(!1),W(0),z(0),C(),B(e||"Session expired, please login again")},ea=async e=>{try{let t=await (0,y.kS)(e);if(!0!==t.success)return!1;return!0}catch(e){return console.log("error",e),!1}};var er=s(2265),ei=s(4695);function en(){return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"text-white text-lg font-semibold",children:"Helpdesk Chatbot"})})}var el=s(3550),eo=s(9827);let ec=/((?:https?:\/\/[^\s\u4e00-\u9fa5，。）》"'）】}>]+|www\.[^\s\u4e00-\u9fa5，。）》"'）】}>]+))/g,ed=/\.(png|jpg|jpeg)$/i,em=/\.(pdf|docx?|xlsx?|pptx?|txt|csv)$/i,eu=RegExp("\\[file\\](.*?)\\[\\/file\\]","gs"),eg=e=>e.split(".").pop().toLowerCase(),ep=e=>e.split("/").pop().split("?")[0],eh=function(e,t,s){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if("link"===e.type){let i=e.text,n=ep(i);return i.match(ed)?(0,a.jsx)("div",{className:"relative inline-block py-1",children:(0,a.jsx)("img",{src:i+"?".concat(s),alt:"Image",className:"max-w-full h-auto cursor-pointer rounded-lg",onClick:()=>ef(i+"?".concat(s)),onError:e=>e.target.src="images/response-bot/broken-image.jpg"})},t):i.match(em)?(0,a.jsxs)("div",{className:"text-primary p-2 rounded-lg text-sm my-2",style:{backgroundColor:"#F5F5F5"},children:[(0,a.jsxs)("div",{className:"flex justify-center items-center",children:[(0,a.jsx)(eo.Z,{}),(0,a.jsx)("a",{href:i+"?".concat(s),target:"_blank",rel:"noopener noreferrer",className:"ml-2 line-clamp-1",style:{textDecoration:"underline"},children:n})]}),(0,a.jsx)("div",{className:"text-xs flex w-full justify-end",children:(0,a.jsxs)("p",{children:[".",eg(n)]})})]},t):(0,a.jsx)("a",{href:i.startsWith("www.")?"https://".concat(i):i,target:"_blank",rel:"noopener noreferrer",className:"font-semibold ".concat(r?"text-white":"text-primary"),style:{textDecoration:"underline",wordBreak:"break-all",WebkitBoxOrient:"vertical",WebkitLineClamp:3,overflow:"hidden"},children:i},t)}if("file"===e.type){let r=e.text.trim(),i=ep(r),n=eg(i);return ed.test(i)?(0,a.jsx)("div",{className:"relative inline-block py-1",children:(0,a.jsx)("img",{src:r+"?".concat(s),alt:"Image",className:"max-w-full h-auto cursor-pointer rounded-lg",onClick:()=>ef(r+"?".concat(s)),onError:e=>e.target.src="images/response-bot/broken-image.jpg"})},t):(0,a.jsxs)("div",{className:"text-primary p-2 rounded-lg text-sm my-2",style:{backgroundColor:"#F5F5F5"},children:[(0,a.jsxs)("div",{className:"flex justify-center items-center",children:[(0,a.jsx)(eo.Z,{}),(0,a.jsx)("a",{href:r+"?".concat(s),target:"_blank",rel:"noopener noreferrer",className:"ml-2 line-clamp-1",style:{textDecoration:"underline"},children:i})]}),(0,a.jsx)("div",{className:"text-xs flex w-full justify-end",children:(0,a.jsxs)("p",{children:[".",n]})})]},t)}return"bold"===e.type?(0,a.jsx)("strong",{children:e.text},t):"italic"===e.type?(0,a.jsx)("em",{children:e.text},t):e.text.split("\n").map((s,r)=>(0,a.jsxs)(er.Fragment,{children:[s,r<e.text.split("\n").length-1&&(0,a.jsx)("br",{})]},"".concat(t,"-").concat(r)))},ef=e=>{{let t=document.createElement("div");t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.backgroundColor="rgba(0, 0, 0, 0.8)",t.style.display="flex",t.style.justifyContent="center",t.style.alignItems="center",t.style.zIndex="1000",t.style.cursor="pointer";let s=document.createElement("img");s.src=e,s.style.maxWidth="90%",s.style.maxHeight="90%",s.style.objectFit="contain",t.appendChild(s),t.addEventListener("click",()=>{document.body.removeChild(t)}),document.body.appendChild(t)}},ex=function(e,t){let s,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[],i=0,n=[...e.matchAll(eu)];if(n.length>0)return(r=n.map(e=>({type:"file",text:e[1].trim()}))).map((e,s)=>eh(e,s,t,a));for(ec.lastIndex=0;null!==(s=ec.exec(e));){if(s.index>i){let t=e.slice(i,s.index);r.push({type:"text",text:t})}let t=s[1].trim();r.push({type:"link",text:t}),i=s.index+s[0].length}if(i<e.length){let t=e.slice(i);r.push({type:"text",text:t})}return r.map((e,s)=>eh(e,s,t,a))};function ey(e){var t,s,r,i;let{comment:n,myEmail:l,showUsername:o,sasToken:d}=e,m=n.email===l,u=m?n.message:(null===(t=n.extras)||void 0===t?void 0:t.action)==="bot_reply"?n.message:(null===(i=n.payload)||void 0===i?void 0:null===(r=i.buttons)||void 0===r?void 0:null===(s=r.find(e=>"custom"===e.type))||void 0===s?void 0:s.postback_text)||n.message;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"".concat(m?"flex flex-row-reverse":"flex justify-start"," items-end pb-2"),children:[(0,a.jsx)("div",{className:"flex p-1",children:o&&n.email!==l?(0,a.jsx)("img",{src:"https://dnlbo7fgjcc7f.cloudfront.net/odrkz-jkgdwun8eevlqka/image/upload/t_KCFsdoK1/LOGO-IMIGRASI.png",alt:"Avatar",className:"w-8 rounded-full object-cover",style:{maxWidth:"none"},onError:e=>{e.target.onerror=null,e.target.src="images/response-bot/avatar.svg"}}):m?null:(0,a.jsx)("span",{className:"h-8 w-8 rounded-full"})}),(0,a.jsxs)("div",{className:"".concat(m?"bg-primary rounded-lg rounded-br-none":"bg-white rounded-lg rounded-bl-none border"," px-3 py-2 my-0.5 text-sm"),children:[!m&&o&&(0,a.jsx)("p",{className:"text-primary text-sm font-semibold pb-0.5",children:"Imigrasi"===n.username?"Imigrasi":"Contact Center Imigrasi"}),(0,a.jsx)("div",{className:"".concat(m?"text-white":"text-black"),style:{wordBreak:"break-word"},children:ex(u,d,m)})]}),(0,a.jsx)("div",{className:"text-[8px] p-2 text-primary whitespace-nowrap",children:(0,c.ZM)(n.timestamp)})]},n.id)})}function ev(e){let{comments:t,myEmail:s,isWaiting:r,roomId:i}=e,{setComments:n,lastCommentId:l,setLastCommentId:o,isLoadMore:u,setIsLoadMore:g}=d((0,ei.N)(e=>({setComments:e.setComments,lastCommentId:e.lastCommentId,setLastCommentId:e.setLastCommentId,isLoadMore:e.isLoadMore,setIsLoadMore:e.setIsLoadMore}))),p=b(e=>e.sasToken),[h,x]=(0,er.useState)(!1),y=(0,er.useRef)(null),v=(0,er.useRef)(0),j=(0,er.useRef)(!1),w=null,N=()=>{let e=y.current;e&&(e.scrollTop=e.scrollHeight)},k=async()=>{let e=!1,s="",a=await m.loadComments(i,{last_comment_id:l,after:!1});a.some(e=>0===e.comment_before_id)&&(e=!0,s=a[a.length-1].timestamp,g(!1));let r=a.filter(e=>0!==e.comment_before_id);r.length>0?o(r[r.length-1].id):o(null);let c=r.reverse();n([...c,...t]),e&&n([...f(s),...c,...t])},_=async()=>{x(!0),j.current=!0,v.current=y.current.scrollHeight,await new Promise(e=>setTimeout(e,500)),await k(),x(!1)};return(0,er.useEffect)(()=>{if(j.current){let e=y.current,t=e.scrollHeight-v.current;e.scrollTop+=t,j.current=!1}else N()},[t]),(0,er.useEffect)(()=>{N()},[r]),(0,a.jsxs)("div",{className:"overflow-y-auto p-4",ref:y,children:[u&&t.length>=20?(0,a.jsx)("div",{className:"flex flex-col justify-center",children:(0,a.jsx)("button",{onClick:_,className:"text-xs text-center text-white bg-primary border border-primary rounded-full py-1 px-2 w-1/4 mx-auto",children:"Load More"})}):(0,a.jsx)("div",{className:"flex flex-col justify-center mb-2",children:(0,a.jsx)("p",{className:"text-center text-gray-600 text-sm",children:"You've reached first page"})}),t.map((e,r)=>{let i=(0,c.Ft)(e.timestamp),n=i!==w;w=i;let l=0===r||t[r-1].email!==e.email;return(0,a.jsxs)("div",{children:[n&&(0,a.jsx)("div",{className:"text-xs text-center text-black my-4 bg-gray-200 border border-gray-200 rounded-full py-1 px-2 w-1/2 mx-auto",children:i}),(0,a.jsx)(ey,{comment:e,myEmail:s,showUsername:l,sasToken:p},r)]},r)}),r&&t.length-1&&(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex justify-start items-end",children:[(0,a.jsx)("div",{className:"flex p-1",children:(0,a.jsx)("span",{className:"w-8 rounded-full",children:(0,a.jsx)("img",{src:"https://dnlbo7fgjcc7f.cloudfront.net/odrkz-jkgdwun8eevlqka/image/upload/t_KCFsdoK1/LOGO-IMIGRASI.png",alt:"logo",className:"w-8 rounded-full",style:{maxWidth:"none"}})})}),(0,a.jsx)("div",{className:"bg-white rounded-lg rounded-bl-none border px-3 py-2 my-0.5 text-sm",children:(0,a.jsx)(el.Z,{className:"animate-bounce"})})]})})]})}var ej=s(6648),ew=s(4697),eb=s(6780),eN=s(8184),ek=s(3274);let e_=[".jpeg",".jpg",".png",".pdf",".doc",".docx",".xls",".xlsx"],eI=e=>{let t="."+e.name.split(".").pop().toLowerCase();return e_.includes(t)},eS=(e,t)=>{let s={validFiles:[],invalidFiles:[],invalidTypes:[],errors:[]};return t.length+e.length>3?s.errors.push("Maximum ".concat(3," files allowed. Currently trying to add ").concat(e.length," files when you already have ").concat(t.length," files.")):(e.forEach(e=>{eI(e)?e.size>2097152?s.invalidFiles.push(e.name):s.validFiles.push({file:e,preview:URL.createObjectURL(e)}):s.invalidTypes.push(e.name)}),s.invalidFiles.length>0&&s.errors.push("Files exceeding 2MB: ".concat(s.invalidFiles.join(", "))),s.invalidTypes.length>0&&s.errors.push("Invalid file types: ".concat(s.invalidTypes.join(", "),". Allowed types: ").concat(e_.join(", ")))),s};function eC(e){let{isWaiting:t}=e,s=b(e=>e.email),r=b(e=>e.roomId),i=d(e=>e.isBot),[n,l]=(0,er.useState)([]),[o,c]=(0,er.useState)(!1),[m,u]=(0,er.useState)(!1),[g,p]=(0,er.useState)(""),h=(0,v.getCookie)("data"),f=(0,v.getCookie)("refreshToken"),x=localStorage.getItem("at"),y=localStorage.getItem("cr"),j=localStorage.getItem("itr"),w=e=>{let t=Array.from(e.target.files);if(0===t.length)return;c(!0);let s=eS(t,n);s.errors.length>0?p(s.errors.join("\n")):p(""),s.validFiles.length>0&&l(e=>[...e,...s.validFiles]),e.target.value=""},N=e=>{l(t=>{let s=t.filter((t,s)=>s!==e);return URL.revokeObjectURL(t[e].preview),0!==s.length||g||c(!1),s})},k=async()=>{let e=new FormData;if(n.forEach((t,s)=>{e.append("files",t.file)}),e.append("email",s),e.append("room_id",r),u(!0),200!==(await fetch("/api/upload-file",{method:"POST",body:e})).status){p("Maintenance in progress, please try again later."),u(!1);return}n.forEach(e=>URL.revokeObjectURL(e.preview)),l([]),c(!1),p(""),u(!1)},_=async()=>{try{if(!x||!y||!j){es("Failed to load user data");return}if(i){if(u(!0),!h){es("Failed to load user data");return}let e=await V(h);if(!e.token&&(e.timeleft<300&&!await S(f)||0===e.timeleft)){await et(s,r);return}}await k()}catch(e){console.error("Error sending file:",e),p("An error occurred while sending the file. Please try again.")}},I=()=>{m||(n.forEach(e=>URL.revokeObjectURL(e.preview)),l([]),c(!1),p(""))},C=e=>e.file.type.startsWith("image/")?(0,a.jsx)("div",{className:"relative h-40 w-full",children:(0,a.jsx)(ej.default,{src:e.preview,alt:e.file.name,className:"object-contain rounded",fill:!0})}):"application/pdf"===e.file.type?(0,a.jsx)("div",{className:"h-40 flex items-center justify-center bg-gray-100 rounded",children:(0,a.jsx)("p",{className:"text-gray-500",children:"PDF Document"})}):"application/vnd.openxmlformats-officedocument.wordprocessingml.document"===e.file.type||"application/msword"===e.file.type?(0,a.jsx)("div",{className:"h-40 flex items-center justify-center bg-gray-100 rounded",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Word Document"})}):"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.file.type||"application/vnd.ms-excel"===e.file.type?(0,a.jsx)("div",{className:"h-40 flex items-center justify-center bg-gray-100 rounded",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Excel Document"})}):(0,a.jsx)("div",{className:"h-40 flex items-center justify-center bg-gray-100 rounded",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Unsupported File Type"})});return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"file",accept:e_.join(","),className:"hidden",id:"attachment-input",multiple:!0,disabled:t||m,onChange:w}),o&&(0,a.jsxs)("div",{id:"modal-upload-file",className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50"}),(0,a.jsxs)("div",{className:"relative z-50 bg-white rounded-lg shadow-xl max-w-5xl w-full mx-4",children:[(0,a.jsxs)("div",{className:"border-b p-4 flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:g&&0===n.length?"File Upload Error":"Selected Files"}),(0,a.jsx)("button",{onClick:I,disabled:m,className:"p-1 hover:bg-gray-100 rounded-full",children:(0,a.jsx)(ew.Z,{className:"w-5 h-5"})})]}),g&&(0,a.jsx)("div",{className:"mx-4 mt-4 ".concat(0===n.length?"h-32":""),children:(0,a.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded-r",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(eb.Z,{className:"w-5 h-5 text-red-500 mr-2 mt-0.5 flex-shrink-0"}),(0,a.jsx)("div",{className:"text-sm text-red-700",children:g.split("\n").map((e,t)=>(0,a.jsx)("p",{className:"mb-1 last:mb-0",children:e},t))})]})})}),n.length>0&&(0,a.jsx)("div",{className:"pb-16 pt-6 px-4",children:(0,a.jsx)("div",{className:"grid grid-cols-3 gap-4 max-h-[60vh] overflow-y-auto",children:n.map((e,t)=>(0,a.jsxs)("div",{className:"relative border rounded-lg p-2",children:[(0,a.jsx)("button",{onClick:()=>N(t),className:"absolute top-2 right-2 p-1 bg-red-100 rounded-full hover:bg-red-200 transition-colors z-10",disabled:m,children:(0,a.jsx)(ew.Z,{className:"w-4 h-4 text-red-500"})}),C(e),(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium truncate",children:e.file.name}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[(e.file.size/1024/1024).toFixed(2)," MB"]})]})]},t))})}),n.length<3&&(0,a.jsxs)("div",{className:"absolute bottom-22 left-1/2 transform -translate-x-1/2",children:[(0,a.jsxs)("label",{htmlFor:"modal-file-input",className:"flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-full hover:bg-gray-600 transition-colors cursor-pointer ".concat(t||m?"opacity-50 cursor-not-allowed":""),children:[(0,a.jsx)(eN.Z,{className:"w-4 h-4"}),"Add More Files (",n.length,"/",3,")"]}),(0,a.jsx)("input",{type:"file",id:"modal-file-input",accept:e_.join(","),className:"hidden",multiple:!0,disabled:t||m,onChange:w})]}),(0,a.jsxs)("div",{className:"border-t p-4 flex justify-end gap-2",children:[(0,a.jsx)("button",{className:"min-w-[100px] border rounded-lg p-2 hover:bg-gray-100 transition-colors",onClick:I,disabled:m,children:"Cancel"}),n.length>0&&(0,a.jsx)("button",{onClick:_,disabled:m,className:"min-w-[100px] rounded-lg p-2 transition-colors flex items-center justify-center ".concat(m?"bg-gray-400 text-black-700":"bg-primary text-white hover:bg-primary-dark"),children:m?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ek.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Sending..."]}):"Send Files"})]})]})]})]})}function eE(e){let{className:t,sx:s,children:r,...i}=e;return(0,a.jsx)("button",{className:t,style:s,...i,children:r})}function eL(e){let{email:t,isWaiting:s,setIsWaiting:r,setIsLoading:i,setFirstLoad:n}=e,{roomId:l}=b((0,ei.N)(e=>({roomId:e.roomId}))),{setComments:o,isBot:c}=d((0,ei.N)(e=>({setComments:e.setComments,setBlocked:e.setBlocked,isBot:e.isBot}))),m=(0,v.getCookie)("data"),u=(0,v.getCookie)("refreshToken"),g=localStorage.getItem("at"),p=localStorage.getItem("cr"),h=localStorage.getItem("itr"),[f,x]=(0,er.useState)(""),y=async()=>{if(!m){es("Failed to load user data");return}let e=await V(m);e.token?(await Y(l,f,null,"text",null,null),x(""),r(!0),e.timeleft<300&&!await S(u)&&await et(t,l)):(await Y(l,"Closing",null,"text",null,null),x(""),o([]),i(!0),await et(t,l))},j=async()=>{try{if(!g||!p||!h){es("Failed to load user data");return}c?await y():(await Y(l,f,null,"text",null,null),x(""),r(!1))}catch(e){console.log("error",e)}};return(0,a.jsx)("form",{onSubmit:e=>{e.preventDefault(),f.length>0&&!s&&j()},children:(0,a.jsxs)("div",{className:"p-4 flex items-center bg-white",children:[(0,a.jsx)("textarea",{placeholder:"Type a message...",className:"flex-1 p-2 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none max-h-40 overflow-y-auto",onChange:e=>{x(e.target.value)},rows:1,value:f,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),f.length>0&&!s&&j())}}),f?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(eE,{type:"submit",className:"flex items-center gap-2 text-blue-500 p-2 rounded-lg hover:bg-blue-50 focus:outline-none focus:ring-2 cursor-pointer transition-colors ".concat(s?"opacity-50 cursor-not-allowed":""),disabled:s,children:(0,a.jsx)(ej.default,{src:"/images/form/send.svg",alt:"Send",width:24,height:24})})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("label",{htmlFor:"attachment-input",className:"flex items-center gap-2 text-blue-500 p-2 rounded-lg hover:bg-blue-50 focus:outline-none focus:ring-2 cursor-pointer transition-colors ".concat(s?"opacity-50 cursor-not-allowed":""),children:(0,a.jsx)(ej.default,{src:"/images/form/attachment.svg",alt:"Attachment",width:24,height:24})}),(0,a.jsx)(eC,{isWaiting:s})]})]})})}function eO(e){let{firstLoad:t,setFirstLoad:s,isLoggedIn:r}=e,{setIsLoggedIn:i,email:n,setEmail:l,roomId:o}=b((0,ei.N)(e=>({setIsLoggedIn:e.setIsLoggedIn,email:e.email,setEmail:e.setEmail,roomId:e.roomId}))),{newMessage:c,comments:m,blocked:u}=d((0,ei.N)(e=>({newMessage:e.newMessage,comments:e.comments,blocked:e.blocked}))),{countdown:g,timeleft:p,setTimeleft:h,isWaiting:f,setIsWaiting:y}=(0,x.i)((0,ei.N)(e=>({countdown:e.countdown,timeleft:e.timeleft,setTimeleft:e.setTimeleft,isWaiting:e.isWaiting,setIsWaiting:e.setIsWaiting}))),j=(0,v.getCookie)("data"),[w,N]=(0,er.useState)(!0),k=async()=>{try{i(!0),await _(o,n),l(n)}catch(e){console.error("Error handling cookie:",e),es("Failed to get user"),s(!1),N(!0)}},_=async(e,t)=>{let a=await X(e,t);await ee(a,e),s(!0),N(!1)},I=async()=>{if(0===c[0][0].comment_before_id)return!1;await ee(c[0],o),Q(m,c,n,o)},S=()=>{let e=g-Math.floor(Date.now()/1e3);if(e<=0){h(0);return}h(e)};return(0,er.useEffect)(()=>{t?setTimeout(()=>{N(!1)},1e3):j&&k()},[]),(0,er.useEffect)(()=>{if(g>0){S();let e=setInterval(S,1e3);return()=>clearInterval(e)}},[g]),(0,er.useEffect)(()=>{c.length>0&&I()},[c]),(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"d-flex flex-column min-w-[400px] bg-primary flex flex-col w-full h-svh",children:[(0,a.jsx)("div",{id:"header",className:"flex flex-row justify-content-between align-items-center p-4 gap-4",children:(0,a.jsx)(en,{})}),(0,a.jsx)("div",{className:"flex flex-col space-y-4 overflow-y-auto h-full bg-chat justify-between",children:w?(0,a.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,a.jsx)(ek.Z,{className:"animate-spin",size:50})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ev,{comments:m,myEmail:n,isWaiting:f,roomId:o}),u?(0,a.jsx)("div",{className:"flex justify-center items-center p-2 text-sm text-red-600",children:"You are blocked"}):(0,a.jsx)(a.Fragment,{children:p>0?(0,a.jsxs)("div",{className:"flex justify-center items-center p-2 text-sm bg-white text-red-600",children:[p," seconds for unblocked"]}):(0,a.jsx)(eL,{email:n,isWaiting:f,setIsWaiting:y,setIsLoading:N})})]})})]})})}var eF=s(7138),eT=s(1907);function eR(e){let{error:t,onSubmit:s,loading:r,showPassword:i,togglePasswordVisibility:l,successMessage:o,handleCaptchaVerification:c,handleExpired:d,recaptchaRef:m}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{id:"chatRoom",className:"bg-white p-4 overflow-y-auto h-full",children:(0,a.jsxs)("div",{className:"w-full max-auto mx-auto p-6 rounded-md bg-white",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-primary",children:"Login"}),(0,a.jsx)("p",{className:"text-primary",children:"Login to Apply and Track Your Application"})]}),t&&(0,a.jsx)("p",{className:"text-red-600 text-sm mb-4",children:t}),o&&(0,a.jsx)("p",{className:"text-green-600 text-sm mb-4",children:o}),(0,a.jsxs)("form",{className:"space-y-4",onSubmit:s,children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("label",{className:"block text-base font-medium text-primary",children:["Email",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"absolute left-2 top-11",children:(0,a.jsx)(ej.default,{src:"/images/form/user.svg",alt:"user",width:20,height:20})}),(0,a.jsx)("input",{name:"email",placeholder:"Email",className:"w-full p-3 pl-10 mt-1 border border-gray-300 rounded-md focus:ring focus:ring-blue-300",type:"email",required:!0,autoComplete:"email"})]})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("label",{className:"block text-base font-medium text-primary",children:["Password",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"absolute left-2 top-11",children:(0,a.jsx)(ej.default,{src:"/images/form/key-password.svg",alt:"password",width:20,height:20})}),(0,a.jsx)("input",{name:"password",className:"w-full p-3 pl-10 pr-10 mt-1 border border-gray-300 rounded-md focus:ring focus:ring-blue-300",type:i?"text":"password",placeholder:"Password",required:!0,minLength:8,autoComplete:"new-password"}),(0,a.jsx)("span",{className:"absolute right-2 top-11 cursor-pointer",onClick:l,children:i?(0,a.jsx)(ej.default,{src:"/images/form/eye-open.svg",alt:"show password",width:20,height:20}):(0,a.jsx)(ej.default,{src:"/images/form/eye-silent.svg",alt:"hide password",width:20,height:20})})]})]}),(0,a.jsx)("div",{children:(0,a.jsx)(eT.Z,{sitekey:n.mq,onChange:c,onExpired:d,ref:m})}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{type:"submit",className:"w-full px-4 py-3 text-white bg-primary rounded-md ".concat(r?"opacity-50 cursor-not-allowed":"hover:bg-gray-700"," focus:outline-none focus:ring-2 focus:ring-blue-300"),disabled:r,children:r?"Logging in...":"Login"})}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",(0,a.jsx)(eF.default,{href:"/rgst-acc",children:"Create Account"})]})})]})]})})})}function eA(){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ej.default,{alt:"",src:"/images/header/new-logo-imigrasi.svg",height:100,width:100,style:{objectFit:"contain"},priority:!0}),(0,a.jsx)("h3",{className:"text-white",children:"MINISTRY OF LAW AND HUMAN RIGHTS DIRECTORATE GENERAL OF IMMIGRATION"})]})}var eP=s(6463),eM=s(5898);function eD(e){let{message:t,setSuccessMessage:s}=e,r=(0,eP.useRouter)(),{setRoomId:i,setupUser:n}=b((0,ei.N)(e=>({setRoomId:e.setRoomId,setupUser:e.setupUser}))),{isLoading:l,setIsLoading:o,error:c,setError:d}=(0,x.i)((0,ei.N)(e=>({isLoading:e.isLoading,setIsLoading:e.setIsLoading,error:e.errorLogin,setError:e.setErrorLogin}))),[m,u]=(0,er.useState)(!1),g=(0,er.useRef)(null),[p,h]=(0,er.useState)(""),[f,v]=(0,er.useState)(!1),[j,w]=(0,er.useState)(!1),N=async e=>{try{let t=await (0,eM.Rv)(e);!0!==t.success?(d(t.message),v(!1)):r.push("/cnfrm-otp?email="+e)}catch(e){console.log("error",e),d(e.message),v(!1)}},k=async(e,t)=>{try{r.replace("/chatbot");let a=await (0,y.x4)(e,t);a.success?(s(""),await n(e)?await i(e):(d("Invalid email or password"),g.current.reset(),u(!1))):(a.message.includes("redirecting to login")?(window.open("https://evisa.imigrasi.go.id/front/login","_blank"),d("Your account is already registered, please login to evisa.imigrasi.go.id")):a.message.includes("Please confirm OTP")?await N(e):d(a.message),v(!1),g.current.reset(),u(!1))}catch(e){console.log("error",e),s(""),d(e.message),v(!1),g.current.reset()}},_=async e=>{e.preventDefault();var t=e.target.email.value,s=e.target.password.value;if(!m){d("Please complete the captcha verification.");return}v(!0),await k(t,s),v(!1),o(!1)},I=async e=>{try{if(e){let t=await (0,y.HR)(e);!0!==t.success?(u(!1),d(t.message),g.current.reset()):u(!0)}}catch(e){u(!1),d(e.message),g.current.reset()}};return(0,er.useEffect)(()=>{let e;return l&&(e=setTimeout(()=>{o(!1)},1e3)),()=>clearTimeout(e)},[]),(0,er.useEffect)(()=>{""!==t?(d(""),h(t)):h("")},[t]),(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"d-flex flex-column min-w-[400px] bg-primary flex flex-col w-full h-svh",children:[(0,a.jsx)("div",{id:"header",className:"flex flex-row justify-content-between align-items-center p-4 gap-4",children:(0,a.jsx)(eA,{})}),(0,a.jsx)(eR,{loading:f,error:c,onSubmit:_,showPassword:j,togglePasswordVisibility:()=>{w(!j)},successMessage:p,handleCaptchaVerification:e=>{I(e)},handleExpired:()=>{u(!1)},recaptchaRef:g})]})})}function eU(){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ej.default,{alt:"",src:"/images/header/new-logo-imigrasi.svg",height:100,width:100,style:{objectFit:"contain"},priority:!0}),(0,a.jsx)("h3",{className:"text-white",children:"MINISTRY OF LAW AND HUMAN RIGHTS DIRECTORATE GENERAL OF IMMIGRATION"})]})}function eW(e){let{setDisclaimer:t}=e,[s,r]=(0,er.useState)(null),i=e=>{r(e),e&&t(!0)};return(0,a.jsxs)("div",{className:"d-flex flex-column min-w-[400px] bg-primary flex flex-col w-full h-svh",children:[(0,a.jsx)("div",{id:"header",className:"flex flex-row justify-content-between align-items-center p-4 gap-4",children:(0,a.jsx)(eU,{})}),(0,a.jsx)("div",{className:"bg-white p-4 overflow-y-auto h-full flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-full max-w-md mx-auto p-6 rounded-md bg-white text-center",children:null===s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-primary",children:"Disclaimer"}),(0,a.jsx)("p",{className:"text-primary mb-4",children:"We use cookies to personalize content, to provide feature of Helpdesk chatbot and improve your experience. These cookies help us understand how you interact with our services and allow us to remember your preferences."}),(0,a.jsx)("p",{className:"text-primary mb-4",children:"By accepting cookies, you allow us to:"}),(0,a.jsxs)("ul",{className:"text-primary text-left list-disc pl-8 mb-4",children:[(0,a.jsx)("li",{children:"Remember your login details"}),(0,a.jsx)("li",{children:"Understand how you use our chatbot"}),(0,a.jsx)("li",{children:"Improve our services based on your interactions"}),(0,a.jsx)("li",{children:"Provide personalized assistance"})]}),(0,a.jsx)("hr",{className:"my-4"}),(0,a.jsx)("h1",{className:"text-primary text-xl font-semibold mt-4",children:"Do you agree to accept cookies?"}),(0,a.jsxs)("div",{className:"flex flex-row gap-4 justify-center mt-4",children:[(0,a.jsx)("button",{onClick:()=>i(!0),className:"px-4 py-2 bg-primary text-white hover:bg-slate-600 rounded-md",children:"Yes"}),(0,a.jsx)("button",{onClick:()=>i(!1),className:"px-4 py-2 bg-primary text-white hover:bg-slate-600 rounded-md",children:"No"})]})]}):!1===s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-primary mb-4",children:"Cookie Consent Required"}),(0,a.jsx)("p",{className:"text-primary mb-6",children:"If you want to access the chatbot, please accept the cookie policy."}),(0,a.jsx)("div",{className:"flex flex-col items-center gap-4",children:(0,a.jsx)("button",{onClick:()=>i(!0),className:"px-4 py-2 bg-primary text-white hover:bg-slate-600 rounded-md w-full",children:"Accept Cookies"})})]}):null})})]})}function ez(){let e=(0,eP.useSearchParams)(),{isLoggedIn:t,setIsLoggedIn:s,setupUser:r,setRoomId:i}=b((0,ei.N)(e=>({isLoggedIn:e.isLoggedIn,setIsLoggedIn:e.setIsLoggedIn,setupUser:e.setupUser,setRoomId:e.setRoomId}))),n=b.getState(),[l,o]=(0,er.useState)(""),[c,d]=(0,er.useState)(!1),[u,g]=(0,er.useState)(!0),{firstLoad:p,setFirstLoad:h}=(0,x.i)((0,ei.N)(e=>({firstLoad:e.firstLoad,setFirstLoad:e.setFirstLoad}))),f=(0,er.useRef)(null),y=(0,er.useRef)(null),[j,w]=(0,er.useState)(null),[N,k]=(0,er.useState)(!1),_=async()=>{let e=await E();if(e)try{let{email:t}=e;if(void 0!==t&&""!==t)try{await m.setUser(t,t,t,null,{customer:!0}),0===n.user.length||""===n.roomId?(await r(t),await i(t)):await m.setUserWithIdentityToken({user:JSON.parse(n.user)}),g(!1),s(!0)}catch(e){console.log("error",e),g(!1),es("Failed to load user")}else g(!1),es("Failed to load user"),k(!0),w(!1)}catch(e){C(),g(!1)}else g(!1),n.firstLogin&&es("Failed to load user data")};return(0,er.useEffect)(()=>{_()},[N]),(0,er.useEffect)(()=>{w((0,v.getCookie)("data"))},[t]),(0,er.useEffect)(()=>{e.get("success")&&(d(!0),o(e.get("success")))},[e]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(a.Fragment,{children:j?t&&!u?(0,a.jsx)("div",{ref:f,children:(0,a.jsx)(eO,{firstLoad:p,setFirstLoad:h,isLoggedIn:t})}):(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"d-flex flex-column min-w-[400px] bg-primary flex flex-col w-full h-svh",children:[(0,a.jsx)("div",{id:"header",className:"flex flex-row justify-content-between align-items-center p-4 gap-4",children:(0,a.jsx)(en,{})}),(0,a.jsx)("div",{className:"flex justify-center items-center h-full bg-chat",children:(0,a.jsx)(ek.Z,{className:"animate-spin",size:50})})]})}):c?(0,a.jsx)("div",{ref:y,children:(0,a.jsx)(eD,{message:l,setSuccessMessage:o})}):(0,a.jsx)(eW,{setDisclaimer:d})})})}},2643:function(e,t,s){"use strict";s.d(t,{C4:function(){return r},NN:function(){return n},Q1:function(){return i},Vw:function(){return o},ei:function(){return c},j8:function(){return l},mq:function(){return d}});var a=s(357);let r=a.env.NEXT_FE_URL,i=a.env.NEXT_API_QISCUS_BASE_URL,n=a.env.NEXT_QISCUS_SECRET_KEY,l="odrkz-jkgdwun8eevlqka",o=a.env.NEXT_API_WEBHOOK,c=a.env.NEXT_API_WEBHOOK_KEY;a.env.NEXT_API_WEBHOOK_NEW_KEY,a.env.NEXT_AES_SECRET_IV,a.env.NEXT_AES_SECRET_KEY;let d="6LdFyMAqAAAAAHxPyRmIINhcB8KMDAecWikuXM8n";a.env.NEXT_CAPTCHA_SECRET_KEY},4002:function(e,t,s){"use strict";s.d(t,{HR:function(){return n},LL:function(){return r},kS:function(){return i},x4:function(){return a}}),s(2643);let a=async(e,t)=>{var s;let a=await fetch("/api/users",{method:"POST",body:JSON.stringify({email:e,password:t})}),r=await a.json();return(null==r?void 0:null===(s=r.data)||void 0===s?void 0:s.code)!==200?{success:!1,message:(null==r?void 0:r.message)?r.message:r.error}:{data:r.data,success:!0,message:"Login success"}},r=async e=>{let t=await fetch("/api/qiscus",{method:"POST",body:JSON.stringify({user_id:e})}),s=await t.json();return 200!==s.data.code?{success:!1,message:"Invalid email or password"}:{data:s.data,success:!0,message:"Login success"}},i=async e=>{var t;let s=await fetch("/api/logout",{method:"POST",body:JSON.stringify({email:e})}),a=await s.json();return(null==a?void 0:null===(t=a.data)||void 0===t?void 0:t.code)!==200?{success:!1,message:(null==a?void 0:a.message)?a.message:a.error}:{success:!0,message:"Logout success"}},n=async e=>{var t;let s=await fetch("/api/confirm-captcha",{method:"POST",body:JSON.stringify({token:e})}),a=await s.json();return(null==a?void 0:null===(t=a.data)||void 0===t?void 0:t.success)!==!0?{success:!1,message:(null==a?void 0:a.message)?a.message:"Failed to confirm captcha"}:{success:!0,message:"Success confirm captcha"}}},5898:function(e,t,s){"use strict";s.d(t,{Rv:function(){return i},U8:function(){return r},z2:function(){return a}});let a=async(e,t,s,a)=>{var r;let i=await fetch("/api/register",{method:"POST",body:JSON.stringify({email:e,password:t,country:s,region:a})}),n=await i.json();return(null==n?void 0:null===(r=n.data)||void 0===r?void 0:r.code)!==200?{success:!1,message:n.error}:{success:!0,message:"Register success"}},r=async(e,t)=>{var s;let a=await fetch("/api/confirm-otp",{method:"POST",body:JSON.stringify({email:e,otp_code:t})}),r=await a.json();return(null==r?void 0:null===(s=r.data)||void 0===s?void 0:s.code)!==200?{success:!1,message:(null==r?void 0:r.error)?r.error:"OTP code is invalid"}:{success:!0,message:"OTP code is valid"}},i=async e=>{var t;let s=await fetch("/api/resend-otp",{method:"POST",body:JSON.stringify({email:e})}),a=await s.json();return(null==a?void 0:null===(t=a.data)||void 0===t?void 0:t.code)!==200?{success:!1,message:(null==a?void 0:a.error)?a.error:"Failed to resend OTP"}:{success:!0,message:"OTP code has been resent"}}},2709:function(e,t,s){"use strict";s.d(t,{i:function(){return n}});var a=s(903),r=s(9291),i=s(6380);let n=(0,a.U)((0,r.tJ)(e=>({isLoading:!0,setIsLoading:t=>e({isLoading:t}),countdown:0,setCountdown:t=>e({countdown:t}),timeleft:0,setTimeleft:t=>e({timeleft:t}),resendCooldown:0,setResendCooldown:t=>e({resendCooldown:t}),errorLogin:!1,setErrorLogin:t=>e({errorLogin:t}),isWaiting:!1,setIsWaiting:t=>e({isWaiting:t}),firstLoad:!1,setFirstLoad:t=>e({firstLoad:t})}),{name:"itr",storage:{getItem:e=>{let t=localStorage.getItem(e);return t?(0,i.pe)(t):null},setItem:(e,t)=>{localStorage.setItem(e,(0,i.HI)(t))}},partialize:e=>({isLoading:e.isLoading,countdown:e.countdown,timeleft:e.timeleft,resendCooldown:e.resendCooldown,isWaiting:e.isWaiting})}))},6380:function(e,t,s){"use strict";s.d(t,{Ft:function(){return l},HI:function(){return d},NV:function(){return g},SG:function(){return o},ZM:function(){return n},oF:function(){return u},pV:function(){return c},pe:function(){return m}}),s(2643);var a=s(8110),r=s.n(a),i=s(9109).lW;let n=e=>new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),l=e=>new Date(e).toLocaleDateString([],{weekday:"long",month:"long",day:"numeric",year:"numeric"}),o=e=>new Date(e).getTime(),c=e=>{let t=e.split("@")[0];return t.charAt(0).toUpperCase()+t.slice(1)},d=e=>r().AES.encrypt(JSON.stringify(e),"m0l1n4Ch4tB0t").toString(),m=e=>JSON.parse(r().AES.decrypt(e,"m0l1n4Ch4tB0t").toString(r().enc.Utf8)),u=e=>i.from(e).toString("base64"),g=e=>i.from(e,"base64").toString("utf-8")}},function(e){e.O(0,[867,648,22,138,729,971,23,744],function(){return e(e.s=2925)}),_N_E=e.O()}]);